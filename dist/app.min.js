var _this=this;function _newArrowCheck(t,e){if(t!==e)throw TypeError("Cannot instantiate an arrow function")}(function(){var t=this;function e(t,e,i,n){var s=this;return void 0===n&&(n=!1),(e=Array.isArray(e)?e:[e]).forEach((function(e){return _newArrowCheck(this,s),t.addEventListener(e,i)}).bind(this)),n&&i(null),{unsubscribe:(function n(){var r=this;_newArrowCheck(this,s),e.forEach((function(e){return _newArrowCheck(this,r),t.removeEventListener(e,i)}).bind(this))}).bind(this)}}_newArrowCheck(this,_this);var i=function(){"use strict";function t(t){this.baseClassName="btn-swipe",this.node=t,this.options={threshold:this.node.dataset.threshold||150,metrikaId:this.node.dataset.metrikaId,metrikaGoalName:this.node.dataset.metrikaEvent},this.container=null,this.link=null,this.toggler=null,this.subscribtions=[],this.initialize()}var i=t.prototype;return i.initialize=function t(){this.prepare(),this.addEventListeners()},i.destroy=function t(){this.removeEventListeners(),this.container.remove(),this.toggler.remove(),this.container=null,this.toggler=null,this.link=null,this.node.style.display=""},i.prepare=function t(){var e=document.createElement("div");e.className=this.baseClassName+"__container",this.container=e;var i=document.createElement("div");i.className=this.baseClassName+"__wrapper "+this.node.dataset.class;var n=document.createElement("div");n.className=this.baseClassName+"__note",n.textContent=this.getNote();var s=document.createElement("a");s.className=this.baseClassName+"__link",s.href=this.getTargetUrl(),this.link=s;var r=document.createElement("span");r.className=this.baseClassName+"__link__toggler",this.toggler=r;var o=document.createElement("span");o.className=this.baseClassName+"__link__label",o.textContent=this.node.textContent,s.appendChild(r),s.appendChild(o),i.appendChild(s),i.appendChild(n),e.appendChild(i),this.node.style.display="none",this.node.parentNode.insertBefore(e,this.node)},i.addEventListeners=function t(){var i,n,s,r,o=this,h=(i=this.fireSwitcherEvent.bind(this),r=0,function(){s=arguments,n=this,clearTimeout(r),r=setTimeout(function(){i.apply(n,s)},30)});this.subscribtions.push(e(this.link,"click",(function(t){_newArrowCheck(this,o),t.target.closest("a, button")&&t.preventDefault()}).bind(this)));var a=0;this.subscribtions.push(e(window,"resize",(function(){_newArrowCheck(this,o),a=this.link.getBoundingClientRect().width-this.toggler.getBoundingClientRect().width-2*window.getComputedStyle(this.link).paddingRight.replace(/(?:(?![,\.0-9\uD800-\uDFFF])[\s\S]|[\uD800-\uDBFF][\uDC00-\uDFFF])+/gim,"")}).bind(this),!0));var l=(function t(e){return _newArrowCheck(this,o),e instanceof TouchEvent?e.changedTouches[0]:e}).bind(this),c=!1,u=null;this.onLink(["mousedown","touchstart"],(function(t){_newArrowCheck(this,o),t.stopPropagation(),t.target.closest("a, button")&&t.preventDefault(),c||!t.target.closest("."+this.toggler.className)||(c=!0,u=l(t).clientX)}).bind(this)),this.subscribtions.push(e(document.documentElement,["mousemove","touchmove"],(function(t){if(_newArrowCheck(this,o),t.stopPropagation(),c){var e=l(t).clientX-u;e=Math.min(a,e=Math.max(0,e)),this.toggler.style.left=e+"px",e===a&&(c=!1,this.toggler.style.left="0px",h())}}).bind(this))),this.subscribtions.push(e(document.documentElement,["mouseup","touchend"],(function(t){_newArrowCheck(this,o),!c||(c=!1,this.toggler.style.left="0px",l(t).clientX-u>=this.options.threshold&&h())}).bind(this)))},i.removeEventListeners=function t(){var e=this;this.subscribtions.forEach((function(t){return _newArrowCheck(this,e),t.unsubscribe()}).bind(this)),this.subscribtions=[]},i.onLink=function t(i,n){var s=e(this.link,i,n);return this.subscribtions.push(s),s},i.fireSwitcherEvent=function t(){var e=this.getTargetUrl();return e?"ym"in window&&this.options.metrikaId?void(this.options.metrikaGoalName&&window.ym(this.options.metrikaId,"reachGoal",this.options.metrikaGoalName),window.ym(this.options.metrikaId,"extLink",e,{callback:function t(){location.href=e}})):void(location.href=e):void 0},i.getTargetUrl=function t(){return this.node.href},i.getNote=function t(){return this.node.dataset.note},t}();window.addEventListener("DOMContentLoaded",(function(){var e=this;_newArrowCheck(this,t),document.querySelectorAll(".btn-swipe").forEach((function(t){_newArrowCheck(this,e),new i(t)}).bind(this))}).bind(this))}).bind(this)();
